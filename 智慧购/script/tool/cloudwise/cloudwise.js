!function(e){function t(e,t){if(s){var n=e+encodeURIComponent(JSON.stringify(t)),r=document.createElement("iframe");r.setAttribute("src",n),document.documentElement.appendChild(r),r.parentNode.removeChild(r),r=null}}function n(){if(0!=o.events.length){var n={type:"cloudwise_monitor_ajax",payload:{url:e.location.href,domain:e.location.hostname,uri:e.location.pathname,events:o.events.splice(0,o.events.length)}};t("cloudwise-agent://ajax?",n)}}function r(){var n=c.getError();if(n.length>0){var r={type:"cloudwise_monitor",payload:{url:e.location.href,domain:e.location.hostname,uri:e.location.pathname,navigationTiming:{},resourceTiming:[],error_list:n}};t("cloudwise-agent://timing?",r)}}var i=3e3,o={base:{},events:[]},a=function(){function t(e,t){if(Object.defineProperty&&Object.keys)try{var n=Object.keys(e);return n.forEach(function(n){Object.defineProperty(t,n,{get:function(){return e[n]},set:function(t){return e[n]=t,t}})}),t}catch(r){}for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}function n(e){return!(e&&"function"==typeof e&&e.apply&&!e[l])}function r(e,t){f[e]=i(e).concat(t)}function i(e){return void 0!=e?f[e]||[]:f}function o(e,t){for(var n=i(e),r=n.length,o=0;o<r;o++)"function"==typeof n[o]&&n[o].apply(this,t)}function a(t,n,r){e.addEventListener?t.addEventListener(n,r,!1):t.attachEvent("on"+n,r)}function c(t,n,r){e.addEventListener?t.removeEventListener(n,r,!1):t.detachEvent("on"+n,r)}function s(e,r,i){function a(){try{var t=this,n=Array.prototype.slice.call(arguments);return o(r+(i||"")+"start",[t,n]),e.apply(t,n)}catch(a){throw a}finally{o(r+(i||"")+"end",[t,n])}}return n(e)?e:(t(e,a),a[l]=!0,e.cloudwise_wrapped=a,a)}function d(e,t,r){for(var i=0,o=t.length;i<o;i++){var a=t[i],c=e[a];n(c)||(e[a]=s(c,a,r))}}function u(e){for(var t=0,n=0;n<e.length;n++)e.charCodeAt(n)>127||94==e.charCodeAt(n)?t+=2:t++;return t}var l="cloudwise_wrapper",f={},m=function(){function t(){o||a||(a=!0,e.addEventListener?document.addEventListener("DOMContentLoaded",r,!1):e.attachEvent&&n())}function n(){try{document.documentElement.doScroll("left")}catch(e){return setTimeout(n,20)}r()}function r(){if(!o){o=!0;for(var t=0;t<i.length;t++)i[t].call(e);i=[]}}var i=[],o=!1,a=!1;return function(n){o?n.call(e):i.push(n),t()}}();return{on:r,listener:i,emit:o,addEvent:a,removeEvent:c,eventsWrapper:s,eventLisenerWrapper:d,lenReg:u,domReady:m}}();e.cloudwiseMonitorUtil=a,function(){var e=["onreadystatechange","onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"];if(XMLHttpRequest){var t=XMLHttpRequest;XMLHttpRequest=function(){var n=new t(arguments);return a.emit("new-xhr",[n]),n.onreadystatechange=function(){},t.prototype.addEventListener&&(n.addEventListener("readystatechange",function(){a.eventLisenerWrapper(this,e,"-xhr-")}),a.eventLisenerWrapper(n,["addEventListener","removeEventListener"],"-xhr-"),n.addEventListener("loadstart",function(){},!1)),n},XMLHttpRequest.cloudwise_original=t,XMLHttpRequest.prototype=t.prototype,a.eventLisenerWrapper(XMLHttpRequest.prototype,["open","send"],"-xhr-"),a.on("open-xhr-start",function(t,n){a.eventLisenerWrapper(t,e,"-xhr-")}),a.on("send-xhr-start",function(t,n){a.eventLisenerWrapper(t,e,"-xhr-")})}}(),function(){function e(e){if("string"==typeof e)return a.lenReg(e);if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer&&e.byteLength)return e.byteLength;if("undefined"!=typeof Blob&&e instanceof Blob&&e.size)return e.size;try{return a.lenReg(JSON.stringify(e))}catch(t){return 0}return 0}function t(t){var n="";switch(t.responseType){case"arraybuffer":case"blob":n=t.response;break;default:n=t.responseText}return e(n)}function n(e){e.cloudwise_metrics&&!e.cloudwise_metrics.firstbyte_time&&(e.cloudwise_metrics.firstbyte_time=(new Date).getTime()),3==e.readyState&&(e.cloudwise_metrics.firstbyte_time=(new Date).getTime()),4==e.readyState&&e.cloudwise_metrics&&(e.cloudwise_metrics.res_time=e.cloudwise_metrics.cb_start_time=e.cloudwise_metrics.lastbyte_time=(new Date).getTime(),e.cloudwise_metrics.rep_code=e.status,e.cloudwise_metrics.code_text=e.statusText,e.cloudwise_metrics.rep_size=t(e),e.cloudwise_metrics.timeout=e.timeout,e.cloudwise_metrics.is_err=e.status<400?0:1)}function r(e){4==e.readyState&&e.cloudwise_metrics&&(e.cloudwise_metrics.cb_end_time=(new Date).getTime(),o.events.push(e.cloudwise_metrics),e.cloudwise_metrics=null)}XMLHttpRequest&&(a.on("new-xhr",function(e,t){e.cloudwise_metrics={eve_type:"ajax"}}),a.on("open-xhr-start",function(e,t){e.cloudwise_metrics.req_url=t[1],e.cloudwise_metrics.req_metnod=t[0].toLocaleLowerCase(),e.cloudwise_metrics.is_asyn=t[2]}),a.on("send-xhr-start",function(t,n){t.cloudwise_metrics.req_time=(new Date).getTime(),t.cloudwise_metrics.req_size=e(n[0])}),a.on("onreadystatechange-xhr-start",function(e,t){n(e)}),a.on("onreadystatechange-xhr-end",function(e,t){r(e)}),a.on("onload-xhr-start",function(e,t){n(e)}),a.on("onload-xhr-end",function(e,t){r(e)}),a.on("addEventListener-xhr-start",function(e,t){var n=t[1];"function"==typeof n&&(t[1]=n.cloudwise_wrapped||a.eventsWrapper(n,"eventListener-xhr-fn-"))}),a.on("removeEventListener-xhr-start",function(e,t){var n=t[1].cloudwise_wrapped;n&&(t[1]=n)}),a.on("eventListener-xhr-fn-start",function(e,t){var r=t[0];"readystatechange"!=r.type&&"load"!=r.type||n(e)}),a.on("eventListener-xhr-fn-end",function(e,t){var n=t[0];"readystatechange"!=n.type&&"load"!=n.type||r(e)}))}();var c=function(){var t=[];return e.addEventListener&&e.addEventListener("error",function(n){var r={};r.time=n.timeStamp||(new Date).getTime(),r.url=n.filename||e.location.href,r.msg=n.message,r.line=n.lineno,r.column=n.colno,n.error?(r.type=n.error.name,r.stack=n.error.stack):(r.msg.indexOf("Uncaught ")>-1?r.stack=r.msg.split("Uncaught ")[1]+" at "+r.url+":"+r.line+":"+r.column:r.stack=r.msg+" at "+r.url+":"+r.line+":"+r.column,r.type=r.stack.slice(0,r.stack.indexOf(":"))),r.type.toLowerCase().indexOf("script error")>-1&&(r.type="ScriptError"),t.push(r)},!1),{getError:function(){return t.splice(0,t.length)}}}(),s=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);navigator.userAgent.toLowerCase().indexOf("android")>-1;e.cloudwisePreMonitor=function(){function t(){o&&(o=!1,n(),r())}e.setInterval(function(){n(),r()},i);var o=!0;a.addEvent(e,"beforeunload",t),a.addEvent(e,"unload",t)},cloudwisePreMonitor()}(this),function(e){function t(e){if(o){var t="cloudwise-agent://timing?"+encodeURIComponent(JSON.stringify(e)),n=document.createElement("iframe");n.setAttribute("src",t),document.documentElement.appendChild(n),n.parentNode.removeChild(n),n=null}}function n(){var n=3e3,o=e.location.href,a=e.location.hostname,c=e.location.pathname,s=i.getInfo();setTimeout(function(){var e={type:"cloudwise_monitor",payload:{url:o,domain:a,uri:c,navigationTiming:r.getNavigationTiming(),resourceTiming:r.getResourceTiming(),error_list:[],sc_time:s.time||r.getNavigationTiming().loadEventStart||+new Date,sc_width:s.width,sc_height:s.height}};t(e)},0);var d=function(){var e=r.getResourceTiming();if(e.length>0){var n={type:"cloudwise_monitor",payload:{url:o,domain:a,uri:c,navigationTiming:{},resourceTiming:e,error_list:[]}};t(n)}};e.setInterval(d,n);var u=!0;e.addEventListener("beforeunload",function(){u&&(u=!1,d())}),e.addEventListener("unload",function(){u&&(u=!1,d())})}var r=function(){function t(){if(!e.performance||!e.performance.timing)return{};var t=e.performance.timing;return{navigationStart:t.navigationStart,redirectStart:t.redirectStart,redirectEnd:t.redirectEnd,fetchStart:t.fetchStart,domainLookupStart:t.domainLookupStart,domainLookupEnd:t.domainLookupEnd,connectStart:t.connectStart,secureConnectionStart:t.secureConnectionStart?t.secureConnectionStart:t.connectEnd-t.secureConnectionStart,connectEnd:t.connectEnd,requestStart:t.requestStart,responseStart:t.responseStart,responseEnd:t.responseEnd,unloadEventStart:t.unloadEventStart,unloadEventEnd:t.unloadEventEnd,domLoading:t.domLoading,domInteractive:t.domInteractive,domContentLoadedEventStart:t.domContentLoadedEventStart,domContentLoadedEventEnd:t.domContentLoadedEventEnd||r,domComplete:t.domComplete,loadEventStart:t.loadEventStart,loadEventEnd:t.loadEventEnd,pageTime:(new Date).getTime()}}function n(){if(!e.performance||!e.performance.getEntriesByType)return[];for(var t=e.performance.getEntriesByType("resource"),n=[],r=0;r<t.length;r++){var i=t[r].secureConnectionStart?t[r].secureConnectionStart:t[r].connectEnd-t[r].secureConnectionStart,o={connectEnd:t[r].connectEnd,connectStart:t[r].connectStart,domainLookupEnd:t[r].domainLookupEnd,domainLookupStart:t[r].domainLookupStart,duration:t[r].duration,entryType:t[r].entryType,fetchStart:t[r].fetchStart,initiatorType:t[r].initiatorType,name:t[r].name,redirectEnd:t[r].redirectEnd,redirectStart:t[r].redirectStart,requestStart:t[r].requestStart,responseEnd:t[r].responseEnd,responseStart:t[r].responseStart,secureConnectionStart:i,startTime:t[r].startTime};n.push(o)}return n}var r=(new Date).getTime();return document.addEventListener("DOMContentLoaded",function(){r=(new Date).getTime()}),{cacheResourceTimingLength:0,getNavigationTiming:function(){return t()},getResourceTiming:function(){var e=n(),t=e.length;return e.length!=this.cacheResourceTimingLength?(e=e.slice(this.cacheResourceTimingLength,t),this.cacheResourceTimingLength=t,e):[]}}}(),i=function(){function t(t){var n=0;n=e.pageYOffset?e.pageYOffset:document.documentElement.scrollTop;try{n+=t.getBoundingClientRect().top}catch(r){}finally{return n}}function n(){this.removeEventListener?this.removeEventListener("load",n,!1):this.attachEvent&&this.detachEvent("onreadystatechange",n);var e=+new Date,r=t(this);r<i&&(o=e>o?e:o)}var r=document.documentElement.clientWidth,i=document.documentElement.clientHeight,o=0;return document.addEventListener("DOMContentLoaded",function(){for(var e=document.getElementsByTagName("img"),t=0;t<e.length;t++){var r=e[t];r.addEventListener?r.complete||r.addEventListener("load",n,!1):r.attachEvent&&r.attachEvent("onreadystatechange",function(){"complete"==r.readyState&&n.call(r)})}}),{getInfo:function(){return{height:i,width:r,time:o}}}}(),o=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);navigator.userAgent.toLowerCase().indexOf("android")>-1;e.cloudwiseStartPageMonitor=n,cloudwiseMonitorUtil.addEvent(e,"load",function(){n()})}(this),function(){function e(e,t,n){return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n),this}for(var t=window.location.host,n=0,r=!1,i=["iPad","iPhone","iPod"];n<i.length;n++)if(navigator.platform.indexOf(i[n])>=0){r=!0;break}var o=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent),a=navigator.userAgent.toLowerCase().indexOf("android")>-1,c={callbacks:{},send:function(e,t){this.dispatchMessage("event",e,t)},sendCallback:function(e){var t=s.createEnvelope(e);this.dispatchMessage("callback",t,function(){})},triggerCallback:function(e){var t=this;setTimeout(function(){t.callbacks[e]&&t.callbacks[e]()},0)},dispatchMessage:function(e,t,n){var r=this;if(this.callbacks[t.id]=function(){n(),delete r.callbacks[t.id]},o){var i="cloudwise://"+e+"/"+t.id+"?"+encodeURIComponent(JSON.stringify(t)),c=document.createElement("iframe");c.setAttribute("src",i),document.documentElement.appendChild(c),c.parentNode.removeChild(c),c=null}else a&&jsinterface.send(JSON.stringify(t))}},s={listeners:{},dispatcher:null,messageCount:0,on:function(e,t){(!this.listeners.hasOwnProperty(e)||!this.listeners[e]instanceof Array)&&(this.listeners[e]=[]),this.listeners[e].push(t)},off:function(e){(!this.listeners.hasOwnProperty(e)||!this.listeners[e]instanceof Array)&&(this.listeners[e]=[]),this.listeners[e]=[]},send:function(e,t,n){t instanceof Function&&(n=t,t=null),t=t||{},n=n||function(){};var r=this.createEnvelope(this.messageCount,e,t);this.dispatcher.send(r,n),this.messageCount+=1},trigger:function(e,t,n){for(var r=this,i=this.listeners[e]||[],o=0,a=function(){o+=1,o>=i.length&&r.dispatcher.sendCallback(t)},c=0;c<i.length;c++){var s=i[c];s.length<=1?(s(n),a()):s(n,a)}},triggerCallback:function(e){this.dispatcher.triggerCallback(e)},createEnvelope:function(e,n,r){return{id:e,type:n,host:t,payload:r}}},d={send:function(e,t){t()},triggerCallback:function(){},sendCallback:function(){}};r&&o||a?s.dispatcher=c:s.dispatcher=d,window.Cloudwise=s,window.CloudwiseAddEvent=function(){function t(e){function t(e){var r=e.nodeName.toLocaleLowerCase();"body"!=r&&"a"!=r&&t(e.parentNode),"a"==r&&(n=!0)}var n=!1;return t(e.parentNode),n}cloudwiseMonitorUtil.domReady(function(){for(var t=document.getElementsByTagName("a"),n=0,r=t.length;n<r;n++)e(t[n],"click",function(e){var t=this.innerText,n=this.href;t=t.replace(/<.*[^>]*>/g,""),s.send("onclick",{linkText:t.replace(/[\\r\\n]/g,""),linkUrl:n})})}),window.onclick=function(e){var n=e.target,r=t(n);if(!r){var i=n.innerHTML;i?i=i.replace(/<.*[^>]*>/g,""):"img"==n.tagName.toLocaleLowerCase()&&(i=n.alt||""),s.send("onclick",{linkText:i.replace(/[\\r\\n]/g,""),linkUrl:""})}}},CloudwiseAddEvent()}();